import{e as t,y as i,dq as R,n as k,al as S,dw as d,ar as T,as as E,dx as I,dy as L,r as g,aw as M,cI as y,dz as P,dA as C,dB as O,dC as $,dD as w,dE as j,dF as A,dG as U,dH as V,_ as B,dI as o}from"./index.3224a022.js";let n=class extends S{constructor(e){super(e),this._basemapCache={},this._loadingProjectionEngine=!1,this.nextBasemap=d("hybrid",this._basemapCache),this.view=null}initialize(){T(()=>this.nextBasemap,e=>{e&&!e.loaded&&e.load().catch(()=>{})},E)}destroy(){this.view=null,I(this._basemapCache),this._basemapCache=null}get _nextBasemapSpatialReferenceTask(){return L(this.view,this.nextBasemap)}get _viewSpatialReferenceLocked(){return!("spatialReferenceLocked"in this.view)||this.view.spatialReferenceLocked}get activeBasemap(){var e,a,s;return d((s=(a=(e=this.view)==null?void 0:e.map)==null?void 0:a.basemap)!=null?s:"topo",this._basemapCache)}castNextBasemap(e){return d(e,this._basemapCache)}get state(){const{view:e}=this;if(!(e!=null&&e.ready)||this._nextBasemapSpatialReferenceTask.updating)return"disabled";const{spatialReference:a}=this._nextBasemapSpatialReferenceTask;return this._viewSpatialReferenceLocked&&g(a)&&!e.spatialReference.equals(a)?"incompatible-next-basemap":this._loadingProjectionEngine?"loading":"ready"}async toggle(){if(this.state==="disabled"||this.state==="incompatible-next-basemap")return;const{activeBasemap:e,nextBasemap:a}=this,s=this._viewSpatialReferenceLocked;if(!s){if(await M(()=>!this._nextBasemapSpatialReferenceTask.updating),a!==this.nextBasemap||e!==this.activeBasemap)return;const{spatialReference:p}=this._nextBasemapSpatialReferenceTask;if(!g(p)||y(this.view.spatialReference,p)||P()||C(this.view.spatialReference,p)||(this._loadingProjectionEngine=!0,await O(),this._loadingProjectionEngine=!1),a!==this.nextBasemap||e!==this.activeBasemap)return}this.view.map.basemap=a,s||!g(this._nextBasemapSpatialReferenceTask.spatialReference)||y(this.view.spatialReference,this._nextBasemapSpatialReferenceTask.spatialReference)||(this.view.spatialReference=this._nextBasemapSpatialReferenceTask.spatialReference),this.nextBasemap=e}static getThumbnailUrl(e){if(!e)return null;const{thumbnailUrl:a}=e;if(a)return a;const s=$(e);if(s)return j[s].thumbnailUrl;const p=e.baseLayers.find(m=>!!w(m)().get("portalItem.thumbnailUrl"));return p?w(p)().get("portalItem.thumbnailUrl"):null}};t([i()],n.prototype,"_loadingProjectionEngine",void 0),t([i({readOnly:!0})],n.prototype,"_nextBasemapSpatialReferenceTask",null),t([i({readOnly:!0})],n.prototype,"_viewSpatialReferenceLocked",null),t([i({readOnly:!0})],n.prototype,"activeBasemap",null),t([i()],n.prototype,"nextBasemap",void 0),t([R("nextBasemap")],n.prototype,"castNextBasemap",null),t([i({readOnly:!0})],n.prototype,"state",null),t([i()],n.prototype,"view",void 0),t([i()],n.prototype,"toggle",null),n=t([k("esri.widgets.BasemapToggle.BasemapToggleViewModel")],n);const h=n,l={base:"esri-basemap-toggle esri-widget",secondaryBasemapImage:"esri-basemap-toggle__image--secondary",container:"esri-basemap-thumbnail esri-basemap-toggle__container",image:"esri-basemap-thumbnail__image esri-basemap-toggle__image",imageLoading:"esri-basemap-toggle__image--loading",overlay:"esri-basemap-thumbnail__overlay esri-basemap-toggle__image-overlay",title:"esri-basemap-thumbnail__title esri-basemap-toggle__title",overlayScrim:"esri-basemap-thumbnail__overlay-scrim",disabled:"esri-disabled",loaderAnimation:"esri-widget__loader-animation"};function f(e){const a=h.getThumbnailUrl(e);return a?{backgroundImage:"url("+a+")"}:{backgroundImage:""}}const x={title:!1};let r=class extends V{constructor(e,a){super(e,a),this.messages=null,this.viewModel=new h,this.visibleElements={...x}}loadDependencies(){return Promise.all([B(()=>import("./calcite-icon.44e49688.js"),["assets/calcite-icon.44e49688.js","assets/icon.aaaa3842.js","assets/index.3224a022.js","assets/index.29d59db5.css","assets/observers.df97dc74.js"]),B(()=>import("./calcite-scrim.ff8092aa.js"),["assets/calcite-scrim.ff8092aa.js","assets/scrim.1234eb19.js","assets/index.3224a022.js","assets/index.29d59db5.css","assets/loader.420fbbad.js","assets/guid.663608f8.js"])])}get activeBasemap(){return this.viewModel.activeBasemap}get label(){var e,a;return(a=(e=this.messages)==null?void 0:e.widgetLabel)!=null?a:""}set label(e){this._overrideIfSome("label",e)}get nextBasemap(){return this.viewModel.nextBasemap}set nextBasemap(e){this.viewModel.nextBasemap=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return{...x,...e}}toggle(){return this.viewModel.toggle()}render(){const e=this.viewModel,a=e.state==="disabled"?null:e.activeBasemap,s=e.state==="disabled"?null:e.nextBasemap,p=e.state==="loading",m=e.state==="incompatible-next-basemap",c=s?s.title:"",u=s&&s.loadStatus!=="loaded";let b;const v=this.visibleElements.title&&c,_=m;return(v||_)&&(b=o("div",{class:l.overlay,key:"overlay"},v?o("span",{class:l.title,title:c},c):null,_?o("calcite-scrim",{class:l.overlayScrim,title:this.messages.incompatibleSpatialReference},o("calcite-icon",{icon:"exclamation-mark-triangle"})):null)),o("div",{class:this.classes(l.base,m?l.disabled:null),role:"button","data-basemap-id":s?s.id:"",bind:this,onclick:this._toggle,onkeydown:this._toggle,tabIndex:m?-1:0,title:this.label},o("div",{class:this.classes(l.container,l.secondaryBasemapImage)},o("div",{class:l.image,styles:f(a)})),o("div",{class:l.container},o("div",{class:this.classes(l.image,u?l.imageLoading:null),styles:f(s)},u||p?o("calcite-scrim",null,o("span",{"aria-hidden":"true",role:"presentation",class:l.loaderAnimation})):null),b))}_toggle(){this.toggle()}};t([i({readOnly:!0})],r.prototype,"activeBasemap",null),t([i()],r.prototype,"label",null),t([i(),A("esri/widgets/BasemapToggle/t9n/BasemapToggle")],r.prototype,"messages",void 0),t([i()],r.prototype,"nextBasemap",null),t([i()],r.prototype,"view",null),t([i({type:h})],r.prototype,"viewModel",void 0),t([i()],r.prototype,"visibleElements",void 0),t([R("visibleElements")],r.prototype,"castVisibleElements",null),t([U()],r.prototype,"_toggle",null),r=t([k("esri.widgets.BasemapToggle")],r);const q=r;export{q as default};
