import{e as o,y as u,dF as C,dG as f,n as L,dH as k,dI as n,dJ as T,am as E,ar as b,dK as N,as as x,dL as y,a8 as A,dM as B,dN as $,dO as O,dP as R}from"./index.3224a022.js";import{t as I}from"./SearchViewModel.b4c4186c.js";import"./scaleUtils.cab68ced.js";import"./commonProperties.c3e6b3aa.js";import"./geolocationUtils.12f08bfe.js";import"./project.4c40b375.js";const _={base:"esri-search-result-renderer esri-widget",anchor:"esri-widget__anchor",showMoreResults:"esri-search-result-renderer__more-results--show-more-results",moreResults:"esri-search-result-renderer__more-results",moreResultsList:"esri-search-result-renderer__more-results-list",moreResultsHeader:"esri-search-result-renderer__more-results-header",moreResultsItem:"esri-search-result-renderer__more-results-item",moreResultsListHeader:"esri-search-result-renderer__more-results-list-header"};let p=class extends k{constructor(e,t){super(e,t),this.messages=null,this.showMoreResultsOpen=!1,this.viewModel=null}render(){const e={[_.showMoreResults]:this.showMoreResultsOpen};return n("div",{class:_.base},n("div",{key:"esri-search-renderer__container",class:this.classes(_.moreResults,e)},this.renderSearchResultName(),this.renderMoreResults()))}renderMoreResults(){return n("div",{key:"esri-search-renderer__more-results"},this.renderMoreResultsButton(),this.renderMoreResultsLists())}renderSearchResultName(){var s;const e=(s=this.viewModel)==null?void 0:s.selectedResult,t=e&&e.name||"";return n("div",{key:"esri-search-renderer__result-name",class:_.moreResultsItem},t)}renderMoreResultsLists(){var i;const e=(i=this.viewModel)==null?void 0:i.results,{resultCount:t}=this.viewModel;if(t<2)return null;const s=e.map(a=>this.renderMoreResultsList(a));return n("div",{key:"esri-search-renderer__more-results-container",class:_.moreResultsList},s)}renderMoreResultsButton(){const{messages:e}=this,{resultCount:t}=this.viewModel;return t<2?null:n("div",{key:"esri-search-renderer__more-results-button",class:_.moreResultsItem},n("a",{class:_.anchor,href:"#",bind:this,onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?e.hideMoreResults:e.showMoreResults))}renderMoreResultsHeader(e,t){return n("div",{key:`esri-search-result-renderer__header-${t}`,class:_.moreResultsListHeader},e)}renderMoreResultsList(e){var m,w;const{results:t}=e,s=t.length,i=!!s,a=(m=this.viewModel)==null?void 0:m.selectedResult,c=s===1&&t[0]===a,d=this._getSourceName(e.source,e.sourceIndex),v=((w=this.viewModel)==null?void 0:w.results.length)>1&&!c?this.renderMoreResultsHeader(d,e.sourceIndex):null,h=i&&t.map((g,S)=>this.renderMoreResultsListItem(g,S)),M=i&&!c?n("ul",{key:`esri-search-result-renderer__list-${e.sourceIndex}`},h):null;return i?n("div",{key:`esri-search-result-renderer__results-${e.sourceIndex}`},v,M):null}renderMoreResultsListItem(e,t){return e!==this.get("viewModel.selectedResult")?n("li",{key:`esri-search-result-renderer__list-item-${t}`},n("a",{class:_.anchor,href:"#",tabindex:"0",bind:this,"data-result":e,onclick:this._selectResultClick,onkeydown:this._selectResultClick},e.name)):null}_showMoreResultsClick(e){e.preventDefault(),this.showMoreResultsOpen=!this.showMoreResultsOpen;const t=this.get("viewModel.view.popup");t&&t.reposition()}_selectResultClick(e){e.preventDefault();const t=e.currentTarget["data-result"];this.viewModel&&this.viewModel.select(t)}_getSourceName(e,t){return t===I.ALL_INDEX?this.messages.all:e.name}};o([u(),C("esri/widgets/Search/t9n/Search")],p.prototype,"messages",void 0),o([u()],p.prototype,"showMoreResultsOpen",void 0),o([u()],p.prototype,"viewModel",void 0),o([f()],p.prototype,"_showMoreResultsClick",null),o([f()],p.prototype,"_selectResultClick",null),p=o([L("esri.widgets.Search.SearchResultRenderer")],p);const D=p,r={base:"esri-search esri-widget",loader:"esri-widget__loader",loaderText:"esri-widget__loader-text",loaderAnimation:"esri-widget__loader-animation",esriInput:"esri-input",hasMultipleSources:"esri-search--multiple-sources",isLoading:"esri-search--loading",isSearching:"esri-search--searching",showSuggestions:"esri-search--show-suggestions",showSources:"esri-search--sources",showWarning:"esri-search--warning",container:"esri-search__container",input:"esri-search__input",inputContainer:"esri-search__input-container",form:"esri-search__form",submitButton:"esri-search__submit-button",sourcesButton:"esri-search__sources-button",clearButton:"esri-search__clear-button",sourceName:"esri-search__source-name",suggestionsMenu:"esri-search__suggestions-menu",suggestionList:"esri-search__suggestions-list",suggestionListCurrentLocation:"esri-search__suggestions-list--current-location",sourcesMenu:"esri-search__sources-menu",source:"esri-search__source",warningMenu:"esri-search__warning-menu",warningMenuBody:"esri-search__warning-body",warningMenuHeader:"esri-search__warning-header",warningMenuText:"esri-search__warning-text",noValueText:"esri-search__no-value-text",esriWidgetDisabled:"esri-widget--disabled",button:"esri-widget--button",fallbackText:"esri-icon-font-fallback-text",header:"esri-widget__heading",locate:"esri-icon-locate-circled",menu:"esri-menu",menuList:"esri-menu__list",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuHeader:"esri-menu__header",loadingIcon:"esri-icon-loading-indicator esri-rotating",searchIcon:"esri-icon-search",dropdownIcon:"esri-icon-down-arrow esri-search__sources-button--down",dropupIcon:"esri-icon-up-arrow esri-search__sources-button--up",clearIcon:"esri-icon-close",noticeIcon:"esri-icon-notice-triangle",widgetIcon:"esri-icon-search",disabled:"esri-disabled"},F=/<[a-z/][\s\S]*>/i;let l=class extends k{constructor(e,t){super(e,t),this._activeMenuItemIndex=-1,this._handles=new E,this._inputNode=null,this._menuItemCount=0,this._sourceMenuButtonNode=null,this._sourceListNode=null,this._suggestionListNode=null,this._searchResultRenderer=new D,this._locateFailed=null,this._container=null,this.activeMenu="none",this.disabled=!1,this.iconClass=r.widgetIcon,this.messages=null,this.messagesCommon=null,this.viewModel=new I,this._clearActiveMenu=()=>{this.activeMenu="none"},this._removeActiveMenu=s=>{var a;const i=s.relatedTarget;i&&((a=this._container)==null?void 0:a.contains(i))||this._clearActiveMenu()},this.addHandles([b(()=>this.searchTerm,s=>{(s&&this.activeMenu==="warning"||!s&&!this.get("viewModel.selectedSuggestion.location"))&&this._clearActiveMenu()}),N(()=>{var s;return(s=this.viewModel)==null?void 0:s.allSources},"change",()=>this._watchSourceChanges()),b(()=>this.activeMenu,()=>this._resetActiveMenuItemIndex(),x),b(()=>{var s;return(s=this.viewModel)==null?void 0:s.defaultPopupTemplate},s=>{s&&(s.content=this._renderSearchResultsContent.bind(this))},x)])}destroy(){this._handles.destroy(),this._handles=null,this._cancelSuggest(),this._cancelSearch(),this._searchResultRenderer&&(this._searchResultRenderer.viewModel=null,this._searchResultRenderer.destroy(),this._searchResultRenderer=null)}get displayedSearchTerm(){return`${this.viewModel.searchTerm}`.trim()}get inputId(){return this._buildId("input")}get suggestionsMenuId(){return this._buildId("suggest-menu")}get sourceMenuId(){return this._buildId("source-menu")}get sourceMenuButtonId(){return this._buildId("source-menu-button")}get activeSource(){return this.viewModel.activeSource}get activeSourceIndex(){return this.viewModel.activeSourceIndex}set activeSourceIndex(e){this.viewModel.activeSourceIndex=e}get allPlaceholder(){return this.viewModel.allPlaceholder}set allPlaceholder(e){this.viewModel.allPlaceholder=e}get allSources(){return this.viewModel.allSources}get autoNavigate(){return this.viewModel.autoNavigate}set autoNavigate(e){this.viewModel.autoNavigate=e}get autoSelect(){return this.viewModel.autoSelect}set autoSelect(e){this.viewModel.autoSelect=e}get defaultSources(){return this.viewModel.defaultSources}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get includeDefaultSources(){return this.viewModel.includeDefaultSources}set includeDefaultSources(e){this.viewModel.includeDefaultSources=e}get label(){var e,t;return(t=(e=this.messages)==null?void 0:e.widgetLabel)!=null?t:""}set label(e){this._overrideIfSome("label",e)}get locationEnabled(){return this.viewModel.locationEnabled}set locationEnabled(e){this.viewModel.locationEnabled=e}get maxResults(){return this.viewModel.maxResults}set maxResults(e){this.viewModel.maxResults=e}get maxSuggestions(){return this.viewModel.maxSuggestions}set maxSuggestions(e){this.viewModel.maxSuggestions=e}get minSuggestCharacters(){return this.viewModel.minSuggestCharacters}set minSuggestCharacters(e){this.viewModel.minSuggestCharacters=e}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(e){this.viewModel.popupEnabled=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get portal(){return this.viewModel.portal}set portal(e){this.viewModel.portal=e}get resultGraphic(){return this.viewModel.resultGraphic}set resultGraphic(e){this.viewModel.resultGraphic=e}get resultGraphicEnabled(){return this.viewModel.resultGraphicEnabled}set resultGraphicEnabled(e){this.viewModel.resultGraphicEnabled=e}get results(){return this.viewModel.results}get searchAllEnabled(){return this.viewModel.searchAllEnabled}set searchAllEnabled(e){this.viewModel.searchAllEnabled=e}get searchTerm(){return this.viewModel.searchTerm}set searchTerm(e){this.viewModel.searchTerm=e}get selectedResult(){return this.viewModel.selectedResult}get sources(){return this.viewModel.sources}set sources(e){this.viewModel.sources=e}get suggestions(){return this.viewModel.suggestions}get suggestionsEnabled(){return this.viewModel.suggestionsEnabled}set suggestionsEnabled(e){this.viewModel.suggestionsEnabled=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}clear(){this.viewModel.clear()}focus(){var e;(e=this._inputNode)==null||e.focus(),this.emit("search-focus")}blur(){var e;(e=this._inputNode)==null||e.blur(),this.emit("search-blur")}search(e){this._clearActiveMenu(),this._cancelSuggest(),this._cancelSearch();const t=new AbortController,{signal:s}=t;return this._searchController=t,this.viewModel.search(e,{signal:s}).catch(i=>{if(this._searchController===t)return this._clearActiveMenu(),this._searchController=null,i}).then(i=>{if(this._searchController===t)return this.activeMenu=i.numResults?"none":"warning",this._searchController=null,i})}suggest(e){this._cancelSuggest();const t=new AbortController,{signal:s}=t;return this._suggestController=t,this.viewModel.suggest(e,null,{signal:s}).then(i=>{if(this._suggestController===t)return this._suggestController=null,i.numResults&&this._openSuggestionMenu(),this._scrollToTopSuggestion(),i}).catch(()=>{if(this._suggestController===t)return this._suggestController=null,null})}render(){const{state:e}=this.viewModel,t={[r.disabled]:e==="disabled",[r.esriWidgetDisabled]:this.disabled};return n("div",{class:this.classes(r.base,t)},e==="loading"?this.renderLoader():this.renderContainer())}renderSubmitButton(){const{messages:e,disabled:t}=this;return n("button",{"aria-label":e.searchButtonTitle,bind:this,disabled:t,class:this.classes(r.submitButton,r.button),key:"esri-search__submit-button",onclick:this._handleSearchButtonClick,title:e.searchButtonTitle,type:"button"},n("span",{"aria-hidden":"true",class:r.searchIcon}))}renderWarningMenu(){return n("div",{key:"esri-search__error-menu",class:this.classes(r.menu,r.warningMenu)},n("div",{class:r.warningMenuBody},this.renderWarning()))}renderSourceMenuButton(){const{messages:e,activeMenu:t,sourceMenuId:s,sourceMenuButtonId:i,disabled:a}=this,{activeSourceIndex:c,allSources:d}=this.viewModel;return d.length>1?n("button",{id:i,key:"esri-search__source-menu-button",bind:this,disabled:a,"aria-label":e.searchIn,title:e.searchIn,"aria-haspopup":"true","aria-expanded":(t==="source").toString(),"aria-controls":s,class:this.classes(r.sourcesButton,r.button),onclick:this._handleSourcesMenuToggleClick,onfocus:this._handleSourcesMenuToggleFocus,afterCreate:y,"data-node-ref":"_sourceMenuButtonNode",type:"button"},n("span",{"aria-hidden":"true",class:r.dropdownIcon}),n("span",{"aria-hidden":"true",class:r.dropupIcon}),n("span",{class:r.sourceName},this._getSourceName(c))):null}renderSourcesList(){const{allSources:e,searchAllEnabled:t}=this.viewModel,{_activeMenuItemIndex:s,activeMenu:i,sourceMenuId:a,sourceMenuButtonId:c}=this,d=i==="source"&&s>-1?this._buildId("source-item",s):null;return e.length>1?n("ul",{"aria-activedescendant":d,"aria-labelledby":c,id:a,role:"menu",bind:this,afterCreate:y,onkeydown:this._handleSourceMenuKeydown,onkeyup:this._handleSourceMenuKeyup,"data-node-ref":"_sourceListNode",class:r.menuList,tabIndex:-1},t?this.renderSource(I.ALL_INDEX):null,e.map((v,h)=>this.renderSource(h)).toArray()):null}renderSourcesMenu(){const{allSources:e}=this.viewModel;return e.length>1?n("div",{key:"esri-search__source-menu",class:this.classes(r.menu,r.sourcesMenu)},this.renderSourcesList()):null}renderLoader(){const{messages:e,messagesCommon:t,disabled:s}=this;return n("div",{class:r.loader,key:"base-loader",tabIndex:s?-1:null},n("span",{"aria-hidden":"true",class:r.loaderAnimation}),n("span",{class:r.fallbackText},e.searchButtonTitle),n("span",{class:r.loaderText},t.loading))}renderContainer(){const{allSources:e,state:t}=this.viewModel,{activeMenu:s}=this,i={[r.hasMultipleSources]:e.length>1,[r.isLoading]:t==="loading",[r.isSearching]:t==="searching",[r.showWarning]:s==="warning",[r.showSources]:s==="source",[r.showSuggestions]:s==="suggestion"};return n("div",{tabIndex:-1,afterCreate:a=>{this._container=a,a.addEventListener("focusout",this._removeActiveMenu)},afterRemoved:a=>{a.removeEventListener("focusout",this._removeActiveMenu)},class:this.classes(i,r.container),key:"base-container"},this.renderSourceMenuButton(),this.renderSourcesMenu(),this.renderInputContainer(),this.renderSubmitButton(),this.renderWarningMenu())}renderClearButton(){return this.searchTerm?n("button",{bind:this,disabled:this.disabled,class:this.classes(r.clearButton,r.button),key:"esri-search__clear-button",onclick:this._handleClearButtonClick,onfocus:this._clearActiveMenu,title:this.messages.clearButtonTitle,type:"button"},n("span",{"aria-hidden":"true",class:r.clearIcon})):null}renderLocationGroup(){const{messages:e,locationEnabled:t,displayedSearchTerm:s}=this,i=t&&!s,a=this.activeMenu==="suggestion"&&this._activeMenuItemIndex===0;return i?n("ul",{role:"group",key:"esri-search__suggestion-list-current-location",class:this.classes(r.menuList,r.suggestionList,r.suggestionListCurrentLocation)},n("li",{bind:this,"data-current-location-item":!0,onclick:this._handleUseCurrentLocationClick,id:this._buildId("suggestion-item",0),"aria-selected":(this.activeMenu==="suggestion"&&this._activeMenuItemIndex===0).toString(),role:"option",class:this.classes(r.menuItem,a?r.menuItemFocus:null)},n("span",{"aria-hidden":"true",class:r.locate})," ",e.useCurrentLocation)):null}renderInput(){const{activeMenu:e,locationEnabled:t,displayedSearchTerm:s,messages:i,suggestionsMenuId:a,inputId:c,_activeMenuItemIndex:d,disabled:v}=this,{maxInputLength:h,placeholder:M,searchTerm:m,suggestionCount:w}=this.viewModel,g=!(!(t&&!s)&&!w),S=e==="suggestion"&&d>-1?this._buildId("suggestion-item",d):null;return n("input",{"aria-activedescendant":S,"aria-autocomplete":"list","aria-expanded":(g&&e==="suggestion").toString(),"aria-controls":g?a:null,"aria-haspopup":"listbox","aria-label":i.searchButtonTitle,bind:this,disabled:v,placeholder:M,maxlength:h,autocomplete:"off",type:"text",class:this.classes(r.esriInput,r.input),value:m,id:c,role:"combobox",onkeyup:this._handleInputKeyup,onclick:this._openSuggestionMenu,oninput:this._handleInputPaste,onpaste:this._handleInputPaste,afterCreate:y,"data-node-ref":"_inputNode",onfocus:this.focus,onblur:this.blur,title:m?"":M})}renderForm(){return n("form",{key:"esri-search__form",bind:this,disabled:this.disabled,class:r.form,onsubmit:this._formSubmit,role:"search"},this.renderInput())}renderSuggestList(e){const{sourceIndex:t}=e,s=e.results.length,i=e.results;return s?n("ul",{role:"group",key:`esri-search__suggestion-list-${t}`,class:this.classes(r.menuList,r.suggestionList)},i.map(a=>this.renderSuggestion(a,this._menuItemCount++))):null}renderSuggestionsGroup(){const{suggestions:e}=this.viewModel;return e?e.map(t=>[this.renderSuggestionHeader(t),this.renderSuggestList(t)]):null}renderSuggestionsMenu(){const{displayedSearchTerm:e,locationEnabled:t,suggestionsMenuId:s,inputId:i}=this,{suggestionCount:a}=this.viewModel,c=t&&!e||a;return this._menuItemCount=0,c?n("div",{id:s,key:"esri-search__suggestions-menu",class:this.classes(r.menu,r.suggestionsMenu),role:"listbox","aria-labelledby":i,bind:this,afterCreate:y,"data-node-ref":"_suggestionListNode"},this.renderLocationGroup(),this.renderSuggestionsGroup()):null}renderInputContainer(){return n("div",{key:"esri-search__input-container",class:r.inputContainer},this.renderForm(),this.renderSuggestionsMenu(),this.renderClearButton())}renderSuggestionHeader(e){const{allSources:t,activeSourceIndex:s}=this.viewModel,{sourceIndex:i}=e,a=e.results.length,c=t.length>1&&s===I.ALL_INDEX;return a&&c?n("div",{key:`esri-search__suggestion-header-${i}`,class:r.menuHeader},this._getSourceName(i)):null}renderSuggestion(e,t){const{_activeMenuItemIndex:s,messages:i}=this,{searchTerm:a}=this.viewModel;if(a){const{text:c}=e,d=c||i.untitledResult,v=F.test(d),h=[];if(v)h.push(n("div",{innerHTML:d}));else{const m=this._splitResult(d,a),w=a.toLowerCase();m.forEach((g,S)=>{g&&g.length&&(g.toLowerCase()===w?h.push(n("strong",{key:S},g)):h.push(g))})}const M=this.activeMenu==="suggestion"&&s===t;return n("li",{bind:this,id:this._buildId("suggestion-item",t),"aria-selected":(this.activeMenu==="suggestion"&&this._activeMenuItemIndex===t).toString(),onclick:this._handleSuggestionClick,key:`esri-search__suggestion_${t}`,"data-suggestion":e,role:"option",class:this.classes(r.menuItem,M?r.menuItemFocus:null)},h)}}renderSource(e){const{activeSourceIndex:t,searchAllEnabled:s}=this.viewModel,i={[r.menuItemActive]:e===t,[r.menuItemFocus]:this.activeMenu==="source"&&e===(s?this._activeMenuItemIndex-1:this._activeMenuItemIndex)},a=s?e+1:e;return n("li",{bind:this,key:`esri-search__source-${e}`,id:this._buildId("source-item",a),"aria-checked":(e===t).toString(),onclick:this._handleSourceClick,"data-source-index":e,role:"menuitemradio",class:this.classes(r.source,r.menuItem,i)},this._getSourceName(e))}renderNoResultsWarning(e){const{messages:t}=this,s=e?A(t.noResultsFoundForValue,{value:`"${e}"`}):t.noResultsFound;return n("div",{key:"esri-search__no_results"},n("div",{class:r.warningMenuHeader},t.noResults),n("div",{class:r.warningMenuText},s))}renderEmptySearchWarning(){const{messages:e}=this;return n("div",{key:"esri-search__empty-search"},n("span",{"aria-hidden":"true",class:r.noticeIcon}),n("span",{class:r.noValueText},e.emptyValue))}renderLocateWarning(){const{messages:e}=this;return n("div",{key:"esri-search__locate-error"},n("span",{"aria-hidden":"true",class:r.noticeIcon}),n("span",{class:r.noValueText},e.locateError))}renderWarning(){var i;const{displayedSearchTerm:e,_locateFailed:t}=this,{viewModel:s}=this;return t?this.renderLocateWarning():((i=s.selectedSuggestion)==null?void 0:i.location)||e?this.renderNoResultsWarning(e):this.renderEmptySearchWarning()}_resetActiveMenuItemIndex(){this._activeMenuItemIndex=-1}_buildId(e,t){return`${this.id}-${e}${t===void 0?"":`-${t}`}`}_watchSourceChanges(){const{_handles:e,viewModel:{allSources:t}}=this,s="sources";e.remove(s),t.forEach(i=>e.add(b(()=>i.name,()=>this.scheduleRender()),s))}_handleSourcesMenuToggleFocus(){this.activeMenu!=="source"&&this._clearActiveMenu()}_handleSourcesMenuToggleClick(){var t;const e=this.activeMenu==="source";this.activeMenu=e?"none":"source",this.renderNow(),this.activeMenu==="source"&&((t=this._sourceListNode)==null||t.focus())}_handleClearButtonClick(){this.viewModel.clear(),this._focus()}_handleSearchButtonClick(){this.search()}_handleSuggestionClick(e){const t=e.currentTarget["data-suggestion"];t&&(this._focus(),this.search(t))}_handleUseCurrentLocationClick(){this._useCurrentLocation()}_useCurrentLocation(){this._focus("none"),this._cancelSuggest(),this._cancelSearch();const e=new AbortController,{signal:t}=e;this._searchController=e,this.viewModel.searchNearby({signal:t}).then(s=>{this.activeMenu=s.numResults?"none":"warning"}).catch(()=>{this._locateFailed=!0,this.activeMenu="warning"}).then(()=>{this._searchController=null})}_handleSourceClick(e){this._setSourceFromMenuItem(e.currentTarget)}_setSourceFromMenuItem(e){var s;if(!e)return;const t=e["data-source-index"];this.viewModel.activeSourceIndex=t,this._clearActiveMenu(),(s=this._sourceMenuButtonNode)==null||s.focus()}_cancelSuggest(){this._suggestController&&(this._suggestController.abort(),this._suggestController=null)}_cancelSearch(){this._searchController&&(this._searchController.abort(),this._searchController=null),this._locateFailed=!1}_handleInputKeyup(e){var a;const t=R(e);if(e.ctrlKey||e.metaKey||t==="Copy"||t==="ArrowLeft"||t==="ArrowRight"||t==="Shift")return;if(t==="Tab"||t==="Escape"||e.shiftKey&&t==="Tab")return this._cancelSuggest(),void(t==="Escape"&&this._clearActiveMenu());const s=t==="Home"||t==="End"||t==="ArrowUp"||t==="ArrowDown";if(t==="Enter"&&this._activeMenuItemIndex<0)return void this._cancelSuggest();const i=(a=this._suggestionListNode)==null?void 0:a.getElementsByTagName("li");if(i!=null&&i.length){if(this.activeMenu!=="suggestion"&&this._openSuggestionMenu(),s)return e.preventDefault(),this._cancelSuggest(),void this._handleItemNavigation(t,i,this._suggestionListNode);const c=i[this._activeMenuItemIndex];if(t==="Enter"&&c){const d=c["data-suggestion"];return void(d?(this._focus(),this.search(d)):c["data-current-location-item"]&&this._useCurrentLocation())}}this.viewModel.searchTerm&&this.suggest()}_handleItemNavigation(e,t,s){const i=this._activeMenuItemIndex;e==="Home"&&(this._activeMenuItemIndex=0),e==="End"&&(this._activeMenuItemIndex=t.length-1),e==="ArrowUp"&&(this._activeMenuItemIndex=this._activeMenuItemIndex<=0?t.length-1:this._activeMenuItemIndex-1),e==="ArrowDown"&&(this._activeMenuItemIndex=this._activeMenuItemIndex===t.length-1?0:this._activeMenuItemIndex+1),i!==this._activeMenuItemIndex&&B(t[this._activeMenuItemIndex],s)}_scrollToTopSuggestion(){this._suggestionListNode&&(this._suggestionListNode.scrollTop=0)}_openSuggestionMenu(){this.activeMenu="suggestion"}_handleInputPaste(e){const t=e.target;this.viewModel.searchTerm!==t.value&&(this.viewModel.searchTerm=t.value),this.viewModel.searchTerm&&this.suggest()}_handleSourceMenuKeydown(e){const t=R(e);if($(t)){e.preventDefault();const s=this._sourceListNode.getElementsByTagName("li")[this._activeMenuItemIndex];this._setSourceFromMenuItem(s)}else t!=="ArrowUp"&&t!=="ArrowDown"&&t!=="End"&&t!=="Home"||e.preventDefault()}_handleSourceMenuKeyup(e){var a,c;const t=R(e),s=t==="ArrowUp"||t==="ArrowDown"||t==="End"||t==="Home";if(s&&e.preventDefault(),t==="Escape")return this._clearActiveMenu(),void((a=this._sourceMenuButtonNode)==null?void 0:a.focus());const i=(c=this._sourceListNode)==null?void 0:c.getElementsByTagName("li");return i&&i.length!==0&&s?(this.activeMenu!=="source"&&(this.activeMenu="source"),void this._handleItemNavigation(t,i,this._sourceListNode.parentElement)):void 0}_focus(e){this.focus(),e&&(this.activeMenu=e)}_formSubmit(e){e.preventDefault(),this._activeMenuItemIndex===-1&&this.search()}_getSourceName(e){const{messages:t}=this,s=this.viewModel,{allSources:i}=s,a=i.getItemAt(e);return e===I.ALL_INDEX?t.all:a&&a.name||t.untitledSource}_splitResult(e,t){const s=O(t);return e.replace(new RegExp(`(^|)(${s})(|$)`,"ig"),"$1|$2|$3").split("|")}_renderSearchResultsContent(){return this._searchResultRenderer.showMoreResultsOpen=!1,this._searchResultRenderer.viewModel=this.viewModel,this._searchResultRenderer}};o([u()],l.prototype,"_activeMenuItemIndex",void 0),o([u()],l.prototype,"displayedSearchTerm",null),o([u({readOnly:!0})],l.prototype,"inputId",null),o([u({readOnly:!0})],l.prototype,"suggestionsMenuId",null),o([u({readOnly:!0})],l.prototype,"sourceMenuId",null),o([u({readOnly:!0})],l.prototype,"sourceMenuButtonId",null),o([u()],l.prototype,"activeMenu",void 0),o([u({readOnly:!0})],l.prototype,"activeSource",null),o([u()],l.prototype,"activeSourceIndex",null),o([u()],l.prototype,"allPlaceholder",null),o([u({readOnly:!0})],l.prototype,"allSources",null),o([u()],l.prototype,"autoNavigate",null),o([u()],l.prototype,"autoSelect",null),o([u({readOnly:!0})],l.prototype,"defaultSources",null),o([u()],l.prototype,"disabled",void 0),o([u()],l.prototype,"goToOverride",null),o([u()],l.prototype,"iconClass",void 0),o([u()],l.prototype,"includeDefaultSources",null),o([u()],l.prototype,"label",null),o([u()],l.prototype,"locationEnabled",null),o([u()],l.prototype,"maxResults",null),o([u()],l.prototype,"maxSuggestions",null),o([u(),C("esri/widgets/Search/t9n/Search")],l.prototype,"messages",void 0),o([u(),C("esri/t9n/common")],l.prototype,"messagesCommon",void 0),o([u()],l.prototype,"minSuggestCharacters",null),o([u()],l.prototype,"popupEnabled",null),o([u()],l.prototype,"popupTemplate",null),o([u()],l.prototype,"portal",null),o([u()],l.prototype,"resultGraphic",null),o([u()],l.prototype,"resultGraphicEnabled",null),o([u({readOnly:!0})],l.prototype,"results",null),o([u()],l.prototype,"searchAllEnabled",null),o([u()],l.prototype,"searchTerm",null),o([u({readOnly:!0})],l.prototype,"selectedResult",null),o([u()],l.prototype,"sources",null),o([u({readOnly:!0})],l.prototype,"suggestions",null),o([u()],l.prototype,"suggestionsEnabled",null),o([u()],l.prototype,"view",null),o([T(["search-complete","search-clear","search-start","select-result","suggest-start","suggest-complete"]),u({type:I})],l.prototype,"viewModel",void 0),l=o([L("esri.widgets.Search")],l);const V=l;export{V as default};
