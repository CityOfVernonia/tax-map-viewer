import{cR as k,ce as q,c as N,r as U,aq as j,I as u,cV as $,cW as v,ih as D,cT as O,cU as P,ii as E,ij as x,ik as g,il as S,cS as F}from"./index.3224a022.js";import{c as I,a as w}from"./devEnvironmentUtils.d8d0484c.js";function B(e,t,a,l){return e.name?e.styleName&&e.styleName==="Esri2DPointSymbolsStyle"?V(e,t,l):k(e,t,l).then(r=>M(q(r),e.name,t,a,l)):Promise.reject(new N("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))}function M(e,t,a,l,r){var f,h,d;const y=e.data,i=a&&U(a.portal)?a.portal:j.getDefault(),p={portal:i,url:u(e.baseUrl),origin:"portal-item"},o=y.items.find(n=>n.name===t);if(!o){const n=`The symbol name '${t}' could not be found`;return Promise.reject(new N("symbolstyleutils:symbol-name-not-found",n,{symbolName:t}))}let m=$(v(o,l),p),c=(h=(f=o.thumbnail)==null?void 0:f.href)!=null?h:null;const b=o.thumbnail&&o.thumbnail.imageData;I()&&(m=(d=w(m))!=null?d:"",c=w(c));const R={portal:i,url:u(D(m)),origin:"portal-item"};return O(m,r).then(n=>{const T=l==="cimRef"?P(n.data):n.data,s=E(T,R);if(s&&x(s)){if(c){const W=$(c,p);s.thumbnail=new g({url:W})}else b&&(s.thumbnail=new g({url:`data:image/png;base64,${b}`}));e.styleUrl?s.styleOrigin=new S({portal:a.portal,styleUrl:e.styleUrl,name:t}):e.styleName&&(s.styleOrigin=new S({portal:a.portal,styleName:e.styleName,name:t}))}return s})}function V(e,t,a){const l=F.replace(/\{SymbolName\}/gi,e.name),r=U(t.portal)?t.portal:j.getDefault();return O(l,a).then(y=>{const i=P(y.data);return E(i,{portal:r,url:u(D(l)),origin:"portal-item"})})}export{M as fetchSymbolFromStyle,B as resolveWebStyleSymbol};
